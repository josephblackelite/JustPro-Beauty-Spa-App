<!-- Wappler include head-page="index.html" is="dmx-app" id="chooseaddress" appConnect="local" framework7_6="With App Connect" framework7_icons="local" capacitor="local" components="{dmxDatePicker:{},dmxGoogleMaps:{},dmxGooglePlaces:{},dmxSockets:{},dmxFormatter:{}}" jquery_slim_35="cdn" moment_2="cdn" -->

<div class="page location-tracking" id="chooseaddress" data-name="choose-address" path="/choose-address">
    <dmx-serverconnect id="selected_address_data" url="https://api.justpro.me/api/customer_address_actions/selcted_address_data" site="JustPro-Spa-Backend" dmx-param:address_id="app.main.chooseaddress.address_select_form.select_address.value" sockets="true"></dmx-serverconnect>

    <script is="dmx-flow" id="showAddressSheet" type="text/dmx-flow" autorun>{
  runJS: {function: "showAddressSheet"}
}</script>
    <div class="padding-top padding-bottom">
        <div class="navbar no-hairline no-shadow no-border">
            <div class="navbar-inner" style="padding-right:0px !important; padding-left:0px !important; margin-right:0px !important">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon f7-icons">arrow_left</i>
                    </a>

                </div>

                <div class="title">Address</div>
                <div class="right">
                    <a href="#" class="link panel-open icon-only" data-panel="left">

                        <i class="icon f7-icons">ellipsis_vertical</i>
                    </a>
                </div>
            </div>
        </div>

    </div>
    <div class="toolbar toolbar-bottom toolbar-bottom-md" dmx-show="app.main.chooseaddress.address_select_form.select_address.value">
        <div class="toolbar-inner" style="padding:10px !important">
            <a class="button-18 button-large button-fill bg-color-primary text-color-white" href="" dmx-on:click="run([{runJS:{function:'closeAddressSheet'}},{run:{action:`app.main.navigate(\'/checkout/\'+app.main.chooseaddress.address_select_form.select_address.value,{})`}}])" style="width:100%">Select this address</a>
        </div>
    </div>
    <div class="fab fab-left-bottom">
        <a href="#" dmx-on:click="app.main.chooseaddress.showAddressSheet.run()">
            <i class="bi bi-geo-alt-fill"></i>
        </a>
    </div>
    <div class="page-content wappler-block pt-70 relative">
        <div>

            <dmx-google-maps id="maps" class="full-page-map" height="100%" zoom-control="true" zoom="20" dmx-bind:address="app.main.chooseaddress.selected_address_data.data.query.full_address" dmx-bind:latitude="app.main.chooseaddress.selected_address_data.data.query.latitude" dmx-bind:longitude="app.main.chooseaddress.selected_address_data.data.query.logitude">
                <dmx-google-maps-marker id="marker1" dmx-bind:address="app.main.chooseaddress.selected_address_data.data.query.full_address" dmx-bind:latitude="app.main.chooseaddress.selected_address_data.data.query.latitude" dmx-bind:longitude="app.main.chooseaddress.selected_address_data.data.query.logitude"></dmx-google-maps-marker>
            </dmx-google-maps>
        </div>


        <!-- Choose address -->
        <div class="sheet-modal address-sheet-swipe-to-step" style="height:auto; --f7-sheet-bg-color: #fff;">
            <div class="toolbar">
                <div class="toolbar-inner">
                    <div class="left"></div>
                    <div class="title text-align-center">Where do you want this service?</div>
                    <div class="right"></div>
                </div>
            </div>

            <div class="sheet-modal-inner">
                <div class="block">
                    <div>
                        <a class="button-18 button-small bg-color-primary button-fill " href="" dmx-on:click="run([{runJS:{function:'closeAddressSheet'}},{run:{action:`app.main.navigate(\'/create-new-address\',{})`}}])" style="width:100%">Add a new address</a>
                    </div>
                </div>
                <div class="sheet-modal-swipe-step" dmx-show="app.main.chooseaddress.address_select_form.select_address.value">
                    <div class="">
                        <form action="" is="dmx-serverconnect-form" method="post" id="address_select_form">
                            <div class="list">
                                <ul class="row">
                                    <li class="item-content col-100 item-input item-input-with-value">
                                        <div class="item-inner">
                                            <div class="item-title item-label">My Addresses</div>
                                            <div class="item-input-wrap">
                                                <select id="select_address" class="form-control" dmx-bind:options="app.Current_user.data.customer.customer_addresses" optionvalue="id" optiontext="address_name">
                                                </select>
                                            </div>
                                        </div>

                                    </li>
                                </ul>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="block" dmx-show="app.main.chooseaddress.address_select_form.select_address.value">
                    <a href="#!" class="text-align-center button-4" dmx-on:click="run({runJS:{function:'closeAddressSheet'}})" style="width:100% !important">Close and Continue</a>
                </div>

            </div>
        </div>
    </div>
</div>