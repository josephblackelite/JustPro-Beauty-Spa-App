<!-- Wappler include head-page="index.html" is="dmx-app" id="orders" appConnect="local" framework7_6="With App Connect" framework7_icons="local" capacitor="local" components="{dmxSwiper:{},dmxFormatter:{},dmxPreloader:{},dmxSockets:{}}" -->



<div class="page" id="orders" data-name="orders" path="/orders">
    <dmx-serverconnect id="customers_orders" url="https://api.justpro.me/api/customer_orders/list_orders" site="JustPro-Spa-Backend" dmx-param:customer_id="app.Current_user.data.customer.id" dmx-param:order_status="app.main.orders.booking_status_select_form.booking_status.value" sockets="true" dmx-on:start="app.showPreloader('purple')" dmx-on:done="app.hidePreloader()"></dmx-serverconnect>
    <style>
        .white {
            background-color: #fff !important;
            color: #000 !important;
            font-weight: 600 !important;
        }

        .toggler {
            background-color: #CA522A !important;
            color: #fff !important;
            font-weight: 800 !important;
            font-family: 'Catamaran', sans-serif;
        }
    </style>
    <dmx-value id="provider_booking_dates_query_param" dmx-bind:value="app.main.orders.booking_status_select_form.booking_status.value"></dmx-value>
    <div class="padding-top padding-bottom navbar-extra">
        <div class="navbar no-hairline no-shadow no-border">
            <div class="navbar-inner" style="padding-right:0px !important; padding-left:0px !important; margin-right:0px !important">
                <div class="subnavbar no-border no-shadow bg-color-white">
                    <div class="segmented nametag text-color-white segmented-raised">
                        <button class="button strong text-color-primary" dmx-on:click="app.main.orders.booking_status_select_form.booking_status.setValue('\'\'')" style="font-weight: 800;" dmx-class:toggler="!app.main.orders.provider_booking_dates_query_param.value"><span style="height: 100%;">Upcoming</span> </button>
                        <button class="button strong text-color-primary" dmx-on:click="app.main.orders.booking_status_select_form.booking_status.setValue('completed')" style="font-weight: 800;" dmx-class:toggler="app.main.orders.provider_booking_dates_query_param.value"><span style="height: 100%;">Past</span> </button>

                        <!--
                        <a class="button strong active text-color-white" dmx-class:active="" dmx-class:text-color-black="app.main.orders.provider_booking_dates_query_param.value">Upcoming</a>
                        <a class="button strong text-color-white" dmx-class:active="app.main.orders.provider_booking_dates_query_param.value "  dmx-class:text-color-black="!app.main.orders.provider_booking_dates_query_param.value">Past</a> -->
                    </div>
                </div>
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon f7-icons">arrow_left</i>
                    </a>
                </div>
                <div class="title text-brand">Appointments</div>
                <div class="right">
                    <a href="#" class="link panel-open icon-only" data-panel="left">
                        <i class="icon f7-icons">ellipsis_vertical</i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- <div class="toolbar toolbar-bottom toolbar-bottom-md">
        <div class="toolbar-inner justify-content-center" style="padding:10px !important">
            <a class="button-large rounded-xl button-6 bg-color-primary button-fill text-color-white" style="width:100%" dmx-bind:href="'/order-prompt'">Book Appointment</a>
        </div>
    </div> -->

    <div class="page-content content-area mb-150">
        <dmx-preloader id="justpropreloader" spinner="pulse" color="#ff6600"></dmx-preloader>

        <div class="mb-150">
            <div class="">
                <div class="block text-align-center padding-top padding-bottom" dmx-show="(!app.main.orders.customers_orders.data.query_orders &amp;&amp; !app.main.orders.customers_orders.data.query_orders_null)">
                    <h5 class="custom-font">You don't have any bookings yet.</h5>

                </div>
            </div>

            <!-- Not null -->
            <div class="block" dmx-show="app.main.orders.provider_booking_dates_query_param.value">
                <h5 class="custom-font">{{'You have '+app.main.orders.customers_orders.data.query_orders.count()+' past appointments.'}} </h5>

            </div>
            <div class="card mb-0 no-shadow card-outline" dmx-repeat:repeat_items_slots="app.main.orders.customers_orders.data.query_orders" dmx-show="app.main.orders.provider_booking_dates_query_param.value" dmx-on:click="app.main.navigate('/order-details/'+id+'/'+order_uuid_id,{})" style="width: 100%;">
                <span class="badge margin-right margin-left" dmx-show="(order_status == null)">New</span>
                <span class="badge margin-right margin-left" dmx-show="(order_status == 'accepted')" dmx-class:bg-color-green="(order_status == 'accepted')">Booked</span>
                <span class="badge margin-right margin-left" dmx-show="(order_status == 'completed')" dmx-class:bg-color-blue="(order_status == 'completed')">Done</span>
                <div class="card-content" dmx-on:click="app.main.navigate('/order-details/'+order_item_id,{})">

                    <div class="list media-list no-ios-edges">
                        <ul dmx-on:click="app.main.navigate('/order-details/'+order_item_id,{})">
                            <li class="item-content">
                                <div class="item-media">
                                    <img dmx-bind:src="item_image " width="60" height="60" />
                                </div>
                                <div class="item-inner text-color-black">
                                    <div class="item-title-row">
                                        <div class="item-title strong ">{{item_name.titlecase()}}</div>

                                    </div>
                                    <div class="item-subtitle">{{total_amt.toNumber().formatCurrency('AED', '.', ',', 2)}}</div>
                                    <div class="item-subtitle">{{date.formatDate('dd MMM y')}} at {{time_start.formatDate('hh:mm a')}}</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Null -->
            <div class="block" dmx-show="((app.main.orders.customers_orders.data.query_orders_null.where(`order_status`, 'completed', '!=').count() &gt; 0) &amp;&amp; !app.main.orders.provider_booking_dates_query_param.value)">
                <h5 class="custom-font">{{'You have '+app.main.orders.customers_orders.data.query_orders_null.where(`order_status`, 'completed', '!=').count()+' upcoming appointments.'}} </h5>

            </div>
            <div class="card no-shadow card-outline mb-0" dmx-repeat:repeat_items_slots="app.main.orders.customers_orders.data.query_orders_null" dmx-show="(!app.main.orders.provider_booking_dates_query_param.value &amp;&amp; (order_status != ('completed' || 'rejected')))" dmx-on:click="app.main.navigate('/order-details/'+id+'/'+order_uuid_id,{})" style="width: 100%;">

                <span class="badge margin-right margin-left" dmx-show="(order_status == null)">New</span>
                <span class="badge margin-right margin-left" dmx-show="(order_status == 'accepted')" dmx-class:bg-color-green="(order_status == 'accepted')">Booked</span>
                <span class="badge margin-right margin-left" dmx-show="(order_status == 'completed')" dmx-class:bg-color-blue="(order_status == 'completed')">Done</span>
                <div class="card-content" dmx-on:click="app.main.navigate('/order-details/'+order_item_id,{})">

                    <div class="list media-list no-ios-edges">
                        <ul dmx-on:click="app.main.navigate('/order-details/'+order_item_id,{})">
                            <li class="item-content">
                                <div class="item-media">
                                    <img dmx-bind:src="item_image " width="60" height="60" />
                                </div>
                                <div class="item-inner text-color-black">
                                    <div class="item-title-row">
                                        <div class="item-title strong">{{item_name.titlecase()}}</div>

                                    </div>
                                    <div class="item-subtitle">{{total_amt.toNumber().formatCurrency('AED', '.', ',', 2)}}</div>
                                    <div class="item-subtitle">{{date.formatDate('dd MMM y')}} at {{time_start.formatDate('hh:mm a')}}</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- <div class="page" id="orders" data-name="orders" path="/orders">
    <div class="padding-top padding-bottom">
        <div class="navbar no-hairline no-shadow no-border">
            <div class="navbar-inner" style="padding-right:0px !important; padding-left:0px !important; margin-right:0px !important">
                <div class="left">
                    <a href="#" class="link" dmx-on:click="app.main.back('/home',{force: true})">
                        <i class="icon f7-icons">arrow_left</i>
                    </a>
                </div>
                <div class="title">Appointments</div>
                <div class="right">
                    <a href="#" class="link panel-open icon-only" data-panel="left">
                        <i class="icon f7-icons">ellipsis_vertical</i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <style>
        box-shadow: 10px 5px;
    </style>
    <div class="toolbar toolbar-bottom toolbar-bottom-md no-shadow no-border">
        <div class="toolbar-inner justify-content-center" style="padding:10px !important">
            <a class="button-large rounded-xl button-6 bg-color-primary button-fill text-color-white" style="width:100%" dmx-bind:href="'/order-prompt'">Book Appointment</a>
        </div>
    </div>

    <div class="page-content content-area">

        <div class="col-100">
            <div class="block text-align-center padding-top padding-bottom" dmx-show="(app.customers_orders.data.query.count() < 1)">
                <h5 class="custom-font"> You have not booked any home or salon appointment</h5>

            </div>
        </div>
        <div class="col-100 up-30" style="margin-bottom:150px !important">
            <style>
                .cancelled {
                    background-color: #FEF6F6 !important;
                }

                .completed {
                    background-color: #FAFCF3 !important;
                }
            </style>

            <div class="list box-shadow inset" dmx-repeat:repeat2="app.customers_orders.data.repeatOrders" style="border:1px solid #CCCCCC">
                <div class="list-group media-list" dmx-on:click="app.main.navigate('/order-details/'+id+'/'+order_uuid_id,{})" style="cursor">
                    <ul dmx-repeat:repeat1="items">
                        <li class="list-group-title bg-color-white">
                            {{parent_provider_name.titlecase()}} - {{provider_type.titlecase()}} Visit &nbsp; &nbsp;

                        </li>
                        <li>
                            <a class="item-content text-color-black" dmx-class:cancelled="(order_status == 'rejected')" dmx-class:completed="(order_status == 'completed')">
                                <div class="item-media">
                                    <img dmx-bind:src="item_image" width="60" height="60" style="border-radius:50%" />
                                </div>
                                <div class="item-inner">
                                    <div class="item-title-row">
                                        <div class="item-title"> {{product_name.titlecase()}}</div>
                                    </div>
                                    <div class="item-subtitle">{{total_amt.toNumber().formatCurrency('AED', '.', ',', 2)}}</div>
                                    <div class="item-subtitle">
                                        <span class="badge color-red float-right" dmx-show="(order_status == 'rejected')">Rejected</span>
                                        <span class="badge color-green float-right" dmx-show="(order_status == 'completed')">Completed</span>
                                        <span dmx-show="(order_status == 'pending')"> {{date.formatDate('dd MMM y')+', '+time_start.replace(".", ":")+' - '+time_end.replace(".", ":")}}</span>
                                    </div>
                                </div>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>

        </div>
    </div>
</div> -->