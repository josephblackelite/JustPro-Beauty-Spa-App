<!-- Wappler include head-page="index.html" is="dmx-app" id="orderprompt" appConnect="local" framework7_6="With App Connect" framework7_icons="local" capacitor="local" components="{dmxSwiper:{},dmxFormatter:{},dmxSockets:{},dmxPreloader:{}}" bootstrap_icons="local" fontawesome_5="local" -->

<div class="page page-home" path="/home" data-name="home" id="home">
    <script is="dmx-flow" id="check_location" type="text/dmx-flow" autorun>[
  {
    wait: {delay: 2000}
  },
  {
    condition: {
      if: "{{!app.local_store.data.service_location}}",
      then: {
        steps: {
          run: {
            action: "{{app.local_store.set('service_location',app.main.home.providers.value)}}"
          }
        }
      }
    }
  }
]</script>
    <script is="dmx-flow" id="freelancer_card_toggle" type="text/dmx-flow" autorun="">[
  {
    wait: {delay: 2000}
  },
  {
    condition: {
      if: "{{!app.local_store.data.service_location}}",
      then: {
        steps: {
          run: {
            action: "{{app.local_store.set('service_location',app.main.home.providers.value)}}"
          }
        }
      }
    }
  }
]</script>
    <dmx-datetime id="var1"></dmx-datetime>
    <dmx-serverconnect id="queryServices" url="https://api.justpro.me/api/services/query_services" site="JustPro-Spa-Backend" dmx-param:category="app.local_store.data.state" sockets="true" dmx-on:start="app.showPreloader('deeporange')" dmx-on:done="app.hidePreloader()" dmx-param:product_delivery="app.local_store.data.service_location"></dmx-serverconnect>
    <dmx-serverconnect id="querySalons" url="https://api.justpro.me/api/provider/all_salons" site="JustPro-Spa-Backend" dmx-param:category="app.main.home.selector.value" dmx-on:start="app.showPreloader('deeporange')" dmx-on:done="app.hidePreloader()" dmx-param:product_delivery="app.main.home.providers.value" dmx-param:customer_lat="app.geo.coords.latitude" dmx-param:customer_long="app.geo.coords.longitude" dmx-param:provider_type="app.local_store.data.service_location"></dmx-serverconnect>
    <dmx-serverconnect id="home_service_providers" url="https://api.justpro.me/api/provider/home_services_providers" site="JustPro-Spa-Backend" dmx-param:category="app.main.home.selector.value" dmx-on:start="app.showPreloader('deeporange')" dmx-on:done="app.hidePreloader()" dmx-param:product_delivery="app.main.home.providers.value" dmx-param:customer_lat="app.geo.coords.latitude" dmx-param:customer_long="app.geo.coords.longitude" dmx-param:provider_type="app.local_store.data.service_location"></dmx-serverconnect>
    <dmx-value id="popover_title"></dmx-value>
    <dmx-value id="popover_description"></dmx-value>

    <dmx-serverconnect id="selected_address_data" url="https://api.justpro.me/api/customer_address_actions/selected_address_data" site="JustPro-Spa-Backend" dmx-param:address_id="app.main.home.address_select_form.select_address.value" sockets="true"></dmx-serverconnect>
    <dmx-serverconnect id="available_categories" url="https://api.justpro.me/api/services/query_available_categories" site="JustPro-Spa-Backend" dmx-param:address_id="app.main.home.address_select_form.select_address.value" sockets="true" dmx-param:product_delivery="app.local_store.data.service_location"></dmx-serverconnect>
    <style>
        .strong {
            font-weight: 600 !important;
        }

        .custom-font {
            font-family: 'Maven Pro', sans-serif !important;
        }
    </style>


    <div class="padding-top padding-bottom" style="padding-top:30px !important; padding-bottom:40px !important">
        <div class="navbar no-hairline no-border color-theme-white">
            <div class="navbar-inner" data-name="order-prompt">
                <div class="subnavbar justify-content-right border-top" style="border-top:2px solid #ccc" data-intro="Filter Services" data-title="Welcome!">
                    <div class="list no-margin no-padding" style="width:100%;">
                        <ul style="width:100%;">
                            <li style="width:100%;">
                                <a class="item-link smart-select smart-select-init text-color-black" data-open-in="popup" data-searchbar="true" data-searchbar-placeholder="Search Services" style="position:relative">
                                    <select class="text-color-black custom-font nametag" style="width:100%;" name="selector" id="selector" dmx-on:changed="app.local_store.set('state',app.main.home.selector.value)" dmx-bind:value="app.local_store.data.state" dmx-bind:options="app.main.home.available_categories.data.query_available_categories" optiontext="category.capitalize()" optionvalue="category">
                                        <option value="" class="nametag"><i class="bi bi-search"></i> Show All</option>
                                    </select>
                                    <div class="item-content">
                                        <div class="item-inner">
                                            <div class="item-title custom-font strong"><i class="bi bi-search"></i> Search by Service</div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>




                </div>
                <div class="left">
                    <img src="assets/images/logo-pages.png">


                </div>
                <div class="title">

                </div>
                <div class="right mr-0" style="mr-0">

                    <div class="media" dmx-show="app.Cart.data.count()>0">
                        <a href="/order-confirmation"> <i class="bi bi-basket-fill text-color-primary"></i> <sup>{{app.Cart.data.count()}}</sup></a>
                    </div>

                    <a href="#" class="link panel-open icon-only mr-0 pr-0" data-panel="left" style="margin-right:-30px !important; padding-right:-30px !important">
                        <i class="icon f7-icons">ellipsis_vertical</i>
                    </a>
                </div>



            </div>
        </div>

    </div>



    <div class="toolbar toolbar-bottom toolbar-bottom-md no-shadow" dmx-show="app.Cart.data.count()>0">
        <div class="toolbar-inner justify-content-center" style="padding:10px !important;">
            <a href="/order-confirmation" class="button-6 button-large rounded-lg text-color-white brand-bg" style="width:100%">
                {{app.Cart.data.count()}} &nbsp;<i class="bi bi-basket"></i> &nbsp; Checkout &nbsp;<i class="bi-arrow-right-circle-fill"></i></a>
        </div>
    </div>

    <div class="page-content location-wraper newbg">
        <dmx-preloader id="justpropreloader" spinner="pulse" color="#ff6600"></dmx-preloader>


        <div class="searchbar-backdrop" style="border-bottom:0px !important"></div>
        <div class="container mb-150">



            <div class="list mt-0 up-20">
                <p class="segmented segmented-strong text-color-primary nametag up-40" style="position: sticky">
                    <button class="button strong text-color-primary" dmx-on:click="app.local_store.set('service_location','home')" dmx-class:button-active="(app.local_store.data.service_location == 'home')">Home Service</button>
                    <button class="button strong text-color-primary" dmx-on:click="app.local_store.set('service_location','salon')" dmx-class:button-active="(app.local_store.data.service_location == 'salon')">Salon Visit</button>

                    <span class="segmented-highlight"></span>
                </p>
            </div>


            <div id="services" style="margin-bottom:130px !important">

                <div class="block up-30 bottom-10">
                    <div class="row" style="transition: width 0.5s;">
                        <div class="col-100 text-align-right">
                            <p class="smallfont no-padding no-margin text-color-black">View As:
                                <span dmx-on:click="app.local_store.set('freelacer_card_class_toggle',100)"><i class="bi bi-window-fullscreen"></i></span>
                                <span dmx-on:click="app.local_store.set('freelacer_card_class_toggle',50)"><i class="bi bi-window-split"></i></span>
                            </p>
                        </div>
                    </div>
                </div>


                <div class="block mb-0" dmx-hide="app.main.home.querySalons.state.processing+app.main.home.querySalons.state.executing+app.main.home.home_service_providers.state.processing+app.main.home.home_service_providers.state.executing">

                    <h4 class="custom-font" style="font-size:15px !important">
                        <span dmx-show="(app.local_store.data.service_location == 'salon')"> {{app.main.home.querySalons.data.repeat_providers.count()}} <span dmx-show="app.local_store.data.state">Salons offering {{app.local_store.data.state.titlecase()}} services. </span> <span dmx-hide="app.local_store.data.state">Salons Nearby</span>
                        </span>
                        <span dmx-show="(app.local_store.data.service_location == 'home')">
                            {{app.main.home.home_service_providers.data.repeat_providers.count()}} {{app.local_store.data.state.titlecase()}} Freelancers</span>
                    </h4>


                </div>






                <div class="row no-gap">
                    <div class="col-50" dmx-hide="app.main.home.querySalons.state.processing" dmx-repeat:repeat_salons="app.main.home.querySalons.data.repeat_providers.sort(`distance.Distance`)" dmx-show="(app.local_store.data.service_location == 'salon')" dmx-class:col-100="(app.local_store.data.freelacer_card_class_toggle == 100)">
                        <div class="card demo-card-header-pic no-shadow card-outline border-10" dmx-on:click="app.main.navigate('/provider-services-page/'+id+'/'+staff_name+'/'+app.main.home.selector.value,{})">
                            <div class="ribbon" dmx-show="verified"><span>Verified</span></div>
                            <div class="card-header align-items-flex-end" dmx-style:background-image="'url('+ provider_avatar +')'" style="height:256px; background-position:bottom">
                                <span style="font-size:26px; text-transform:capitalize; strong" class="tajawal nametag">
                                    {{staff_name.capitalize()}}

                                </span>

                            </div>
                            <div class="card-footer no-border bg-transparent" style="padding-top:-210px !important; ">
                                <div class="row">
                                    <div class="col-100 no-padding">
                                        <span class="fa fa-star small" dmx-class:checked="(rating > 0)"></span>
                                        <span class="fa fa-star small" dmx-class:checked="(rating > 1)"></span>
                                        <span class="fa fa-star small" dmx-class:checked="(rating > 2)"></span>
                                        <span class="fa fa-star" dmx-class:checked="(rating > 3)"></span>
                                        <span class="fa fa-star" dmx-class:checked="(rating > 4)"></span>
                                    </div>
                                    <div class="no-padding smallfont">
                                        {{distance.Distance.floor()}} km away
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>

                </div>




                <div class="row no-gap">


                    <div class="col-50" dmx-hide="app.main.home.querySalons.state.processing" dmx-repeat:repeat_salons="app.main.home.home_service_providers.data.repeat_providers.sort(`distance.Distance`)" dmx-show="(app.local_store.data.service_location == 'home')" style="transition: width 0s;" dmx-class:col-100="(app.local_store.data.freelacer_card_class_toggle == 100)">
                        <div class="card demo-card-header-pic no-shadow card-outline border-10" dmx-on:click="run([{run:{action:`app.main.navigate(\'/provider-services-page/\'+parent_provider_id+\'/\'+staff_name+\'/\'+app.main.home.selector.value,{})`}},{run:{action:`app.selected_employee_id.setValue(id)`}},{run:{action:`app.cart_preFill.set(\'employee_id\',id)`}}])">
                            <div class="ribbon" dmx-show="verified"><span>Verified</span></div>
                            <div class="card-header align-items-flex-end" dmx-style:background-image="'url('+ provider_avatar +')'" style="height:256px; background-position:bottom">

                                <span style="font-size:26px; text-transform:capitalize; strong" class="tajawal nametag">

                                    <!--{{}}-->{{staff_name.capitalize()}}
                                </span>
                                <!--<br>
                                        <button class="button-4 btn-dir bg-color-yellow popover-open text-align-center justify-content-center" title="This product is nice" data-popover="#popover1" dmx-on:click="app.main.home.popover_title.setValue(product_name.capitalize());app.main.home.popover_description.setValue(product_description.capitalize())" style="border-radius:50% !important; height:20px; width:20px;display:block !important; padding:0px !important; border:0px !important;">
                                            <i class="bi bi-info-circle-fill fa-fw"></i>
                                        </button>-->
                            </div>
                            <div class="card-footer no-border bg-transparent" style="padding-top:-210px !important; ">
                                <div class="row">
                                    <div class="col-100">
                                        <span class="fa fa-star" dmx-class:checked="(rating > 0)"></span>
                                        <span class="fa fa-star" dmx-class:checked="(rating > 1)"></span>
                                        <span class="fa fa-star" dmx-class:checked="(rating > 2)"></span>
                                        <span class="fa fa-star" dmx-class:checked="(rating > 3)"></span>
                                        <span class="fa fa-star" dmx-class:checked="(rating > 4)"></span>
                                    </div>
                                    <div class="col-100">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="popover" id="popover1">
                <div class="popover-inner">
                    <div class="block">
                        <p>{{app.main.home.popover_title.value.capitalize()}}</p>
                        <p>{{app.main.home.popover_description.value.capitalize()}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>