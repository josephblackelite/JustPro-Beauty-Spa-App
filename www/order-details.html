<!-- Wappler include head-page="index.html" is="dmx-app" id="orders" appConnect="local" framework7_6="With App Connect" framework7_icons="local" capacitor="local" components="{dmxSwiper:{},dmxFormatter:{},dmxSockets:{},dmxPreloader:{}}" -->

<div class="page" id="orderdetails" data-name="ordersdetails" path="/order-details/:id/:uuid">
    <div class="padding-top padding-bottom">
        <div class="navbar no-hairline no-shadow no-border">
            <div class="navbar-inner" style="padding-right:0px !important; padding-left:0px !important; margin-right:0px !important">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon f7-icons">arrow_left</i>
                    </a>
                </div>
                <div class="title">Details</div>
                <div class="right">
                    <a href="#" class="link panel-open icon-only" data-panel="left">
                        <i class="icon f7-icons">ellipsis_vertical</i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="toolbar toolbar-bottom toolbar-bottom-md">
        <div class="toolbar-inner justify-content-center" style="padding:10px !important">
            <a class="button-large rounded-xl button-6 bg-color-primary button-fill text-color-white margin-right" style="width:100%" href="#!" dmx-on:click="app.main.navigate('/cancel-appointment/'+app.main.orderdetails.route.params.id+'/'+app.main.orderdetails.route.params.uuid,{})" dmx-hide="app.main.orderdetails.orderchildren.data.query[0].order_status">Cancel Appointment</a>
            <a class="button-large rounded-xl button-6 bg-color-primary button-fill text-color-white" style="width:100%" href="#!" dmx-on:click="app.main.navigate('/change-appointment-date/'+app.main.orderdetails.orderchildren.data.query[0].order_item_id,{})" dmx-hide="app.main.orderdetails.orderchildren.data.query[0].order_status">Change Appointment date</a>
        </div>
    </div>

    <div class="page-content content-area">
        <dmx-preloader id="justpropreloader" spinner="pulse" color="#ff6600"></dmx-preloader>
        <dmx-serverconnect id="orderinfo" url="https://api.justpro.me/api/customer_orders/order_details" site="JustPro-Spa-Backend" dmx-param:order_id="app.main.orderdetails.route.params.id" dmx-on:start="app.showPreloader('purple')" dmx-on:done="app.hidePreloader()" sockets="true"></dmx-serverconnect>
        <dmx-serverconnect id="orderchildren" url="https://api.justpro.me/api/customer_orders/order_items_details" site="JustPro-Spa-Backend" dmx-param:order_uuid="app.main.orderdetails.route.params.uuid" dmx-on:start="app.showPreloader('purple')" dmx-on:done="app.hidePreloader()" sockets="true"></dmx-serverconnect>

        <div class="col-100" style="margin-bottom:150px !important">


            <div class="block">
                Order Amount
                <h2>{{app.main.orderdetails.orderinfo.data.query.total_amt.toNumber().formatCurrency('AED', '.', ',', 2)}}</h2>
            </div>

            <div class="col-100">
                <h5 class="tajawal mt-10 block text-color-black">You have {{app.main.orderdetails.orderchildren.data.query.count()}} appointment(s) in this booking</h5>


                <!--

                <div class="list media-list">
                    <ul>
                        <li>
                            <a href="#" class="item-link item-content">
                                <div class="item-media">
                                </div>
                                <div class="item-inner">
                                    <div class="item-title-row">
                                        <div class="item-title">{{item_name.titlecase()}}</div>
                                        <div class="item-after">{{total_amt.toNumber().formatCurrency('AED', '.', ',', 2)}}</div>
                                    </div>
                                    <div class="item-subtitle">{{provider_type.titlecase()}} Service</div>
                                    <div class="item-text">

                                    </div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
-->





                <div class="card demo-facebook-card text-color-black" dmx-repeat:fullinfo="app.main.orderdetails.orderchildren.data.query">
                    <div class="card-header">
                        <div class="demo-facebook-avatar"><img width="34px" height="34px" dmx-bind:src="employee_avatar"></div>
                        <div class="demo-facebook-name">{{item_name.titlecase()}}</div>
                        <div class="demo-facebook-date">Booked {{order_dateTime.formatDate('dd MMM y')}}</div>
                    </div>
                    <div class="card-content card-content-padding">
                        <div cl ass="col-100" dmx-show="(order_status == 'pending')">
                            <span dmx-show="(provider_type == 'salon')">
                                <p> You will be served in {{parent_provider_name.titlecase()}} by {{employee_name.titlecase()}} on {{appointment_date.formatDate('dddd dd MMMM y')}} at {{time_slot_start}}. Please arrive earlier.</p>
                                <p>{{shop_number}}, {{building}} {{street}}, {{city}}</p>
                                <p> </p>
                            </span>
                            <span dmx-show="(provider_type == 'home')">
                                You will be served at home by {{employee_name.titlecase()}} on {{appointment_date.formatDate('dddd, dd MMMM y')}} at {{time_slot_start}}. {{employee_name.titlecase()}} will arrive early.

                            </span>
                        </div>
                        <div cl ass="col-100" dmx-show="(order_status == 'completed')">
                            <span dmx-show="(provider_type == 'salon')">
                                You were served in {{parent_provider_name.titlecase()}} by {{employee_name.titlecase()}} on {{appointment_date.formatDate('dddd dd MMMM y')}}. Please rate this service to share your experience.
                            </span>
                            <span dmx-show="(provider_type == 'home')">
                                You were served at home by {{employee_name.titlecase()}} on {{appointment_date.formatDate('dddd, dd MMMM y')}}. Please rate this service to share your experience.
                            </span>
                        </div>

                        <div cl ass="col-100" dmx-show="(order_status == 'rejected')">
                            <span dmx-show="(provider_type == 'salon')">
                                Your order was rejected by {{parent_provider_name.titlecase()}} or {{employee_name.titlecase()}}. A refund is on it's way to your bank account.
                            </span>
                            <span dmx-show="(provider_type == 'home')">
                                Your order was rejected by {{employee_name.titlecase()}}. A refund is on it's way to your bank account.
                            </span>
                        </div>


                    </div>
                    <div class="card-footer justify-content-right text-align-right">
                        <!--<a href="#" class="link">Like</a><a href="#" class="link">Comment</a>-->
                        <span dmx-hide="(provider_type == 'home')"> <a href="" dmx-bind:href="'https://www.google.com/maps/place/?q=place_id:'+google_place_id" class="button-6 text-color-white strong bg-color-black external" dmx-show="(order_status == 'pending')"> View Location</a>
                        </span>
                        <a href="#" class="link button-6 text-color-white strong bg-color-primary" dmx-on:click="app.main.navigate('/review-service/'+provider_service_id,{})" dmx-show="(order_status == 'completed')">Rate Service</a>
                    </div>
                </div>















            </div>
        </div>
        <!-- Toolbar -->
    </div>
</div>