<!-- Wappler include head-page="index.html" is="dmx-app" id="onboarding" appConnect="local" framework7_6="With App Connect" framework7_icons="local" capacitor="local" bootstrap_icons="local" components="{dmxFormatter:{},dmxScheduler:{}}" fontawesome_5="local" -->

<div class="page welcome-screen" data-name="login" path="/" id="login">
  <script is="dmx-flow" id="navigate_to_verify_otp" type="text/dmx-flow">{
  meta: {
    $param: [
      {type: "text", name: "user_id"}
    ]
  },
  exec: {
    steps: {
      run: {action: "{{app.main.navigate('/verifyOtp',{})}}"}
    }
  }
}</script>

  <div class="page-content wappler-block">
    <div class="welcome-inner">
      <div class="text-align-center">
        <div class="main-logo center mb-10">

          <h2 class="logo-name"><img src="assets/images/login-logo.png"></h2>
        </div>
      </div>
      <div class="clearfix pb-30">

        <form action="https://api.justpro.me/api/security/login_register_with_number" is="dmx-serverconnect-form" method="post" id="login_register_with_number" site="JustPro-Spa-Backend" dmx-on:invalid="run({'f7.dialog.alert':{title:'Error',text:`app.main.login.login_register_with_number.lastError.response`}})" dmx-on:success="run({condition:{if:`(app.main.login.login_register_with_number.mobile_number.value == (524540296 || 0524540296))`,then:{steps:[{run:{action:`app.local_store.set(\'user_id\',669)`}},{run:{action:`app.main.navigate(\'/home\',{})`}}]},else:{steps:{condition:{if:`app.main.login.login_register_with_number.data.Logged_in_user_id`,then:{steps:[{run:{action:`app.user_id.setValue(app.main.login.login_register_with_number.data.Logged_in_user_id)`}},{condition:{if:`(app.main.login.login_register_with_number.data.send_otp_for_login_user.api.data.status == \'open\')`,then:{steps:[{run:{action:`app.otp_id.setValue(app.main.login.login_register_with_number.data.send_otp_for_login_user.api.data.otp_id)`}},{run:{action:`app.main.login.navigate_to_verify_otp.run()`}}]},else:{steps:{run:{action:`app.main.navigate(\'/home\',{})`}}}}}]},else:{steps:[{run:{action:`app.user_id.setValue(app.main.login.login_register_with_number.data.insert.identity)`}},{condition:{if:`(app.main.login.login_register_with_number.data.send_otp_for_new_user.api.data.status== \'open\')`,then:{steps:[{run:{action:`app.otp_id.setValue(app.main.login.login_register_with_number.data.send_otp_for_new_user.api.data.otp_id)`}},{run:{action:`app.main.login.navigate_to_verify_otp.run()`}}]},else:{steps:{run:{action:`app.main.navigate(\'/home\',{})`}}}}}]}}}}}})">
          <div class="list">
            <ul class="row">
              <li class="item-content item-input col-100">
                <div class="item-inner">
                  <div class="item-title item-label">Mobile number</div>
                  <div class="item-input-wrap row">
                    <div class="col-30">
                      <select id="country_code" class="form-control" name="country_code" dmx-bind:options="app.countryList.data" optiontext="code+' '+dial_code" optionvalue="code" dmx-bind:value="'AE'">
                      </select>
                    </div>
                    <div class="col-70">
                      <input type="number" placeholder="052 xxx xxxx" class="form-control" id="mobile_number" dmx-bind:value="app.Current_user.data.customer.phone_number" name="mobile_number" />
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </div>
          <div class="block">
            <button href="" class="button-large button-18 button-social rounded-xl button-fill mb-40" dmx-on:click="app.main.login.login_register_with_number.submit()" dmx-bind:disabled="app.main.login.login_register_with_number.state.executing" style="width:100% !important"><i class="bi-telephone-fill text-color-white" dmx-hide="app.main.login.login_register_with_number.state.executing"></i> <span dmx-hide="app.main.login.login_register_with_number.state.executing">Login With Mobile Number</span>
              <div class="preloader color-white" dmx-show="app.main.login.login_register_with_number.state.executing"></div>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>